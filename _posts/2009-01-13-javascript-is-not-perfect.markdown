---
layout: !binary |-
  cG9zdA==
status: !binary |-
  cHVibGlzaA==
published: true
title: !binary |-
  SmF2YVNjcmlwdCBpcyBOb3QgUGVyZmVjdA==
author: !binary |-
  anVzdGlu
author_login: !binary |-
  anVzdGlu
author_email: !binary |-
  am10dWxsb3NzQGdtYWlsLmNvbQ==
author_url: !binary |-
  aHR0cDovLw==
wordpress_id: 140
wordpress_url: !binary |-
  aHR0cDovL2p1c3Rpbi5oYXJtb25pemUuZm0vP3A9MTQw
date: 2009-01-13 02:38:47.000000000 -08:00
categories:
- !binary |-
  RGV2ZWxvcG1lbnQ=
tags:
- !binary |-
  SmF2YVNjcmlwdA==
- !binary |-
  Q29icmE=
comments:
- id: 104
  author: !binary |-
    bGlua3MgZm9yIDIwMDktMDItMDUgJmxhcXVvOyBwYWJsb2lkeg==
  author_email: !binary ""
  author_url: !binary |-
    aHR0cDovL3BhYmxvaWR6LndvcmRwcmVzcy5jb20vMjAwOS8wMi8wNS9saW5r
    cy1mb3ItMjAwOS0wMi0wNS8=
  date: !binary |-
    MjAwOS0wMi0wNSAwODowMTo0MiAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0wMi0wNSAxMjowMTo0MiAtMDgwMA==
  content: ! '[...] JavaScript is Not Perfect Caffeinated Simpleton (tags: javascript)         Blogroll
    [...]'
- id: 106
  author: !binary |-
    QmlubnlWQQ==
  author_email: !binary |-
    Y29tbWVudHNAYmlubnl2YS5jb20=
  author_url: !binary |-
    aHR0cDovL2Jsb2cuYmlubnl2YS5jb20v
  date: !binary |-
    MjAwOS0wMi0wNiAxODo0MjozNyAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0wMi0wNiAyMzo0MjozNyAtMDgwMA==
  content: Another problem with JS is the + overloading. It has caused a huge number
    of bugs in my apps. Also <a href="http://www.openjs.com/articles/semicolon_insertion.php"
    rel="nofollow">semi-colon insertion</a> is a potential problem - although I have
    not had any problem with it yet.
- id: 110
  author: !binary |-
    anVzdGlu
  author_email: !binary |-
    am10dWxsb3NzQGdtYWlsLmNvbQ==
  author_url: !binary |-
    aHR0cDovL2p1c3Rpbi5oYXJtb25pemUuZm0=
  date: !binary |-
    MjAwOS0wMi0wOSAwODo0Njo0NCAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0wMi0wOSAxMzo0Njo0NCAtMDgwMA==
  content: I haven&#39;t found + overloading to be a huge problem. Since there are
    so few types that support +, understanding how it works is usually not terribly
    difficult. Changing how + works is much harder, since there are no hooks into
    the underlying implementation in JavaScript.<br><br>Semi-colon insertion is definitely
    a weird JS quirk. Not a whole lot you can do about it though, except make sure
    you have semi-colons everywhere. JSLint (<a href="http://www.jslint.com/" rel="nofollow">http://www.jslint.com/</a>)
    is a great tool for finding these types of bugs.
- id: 639
  author: !binary |-
    MTIzNDU2
  author_email: !binary ""
  author_url: !binary |-
    aHR0cDovL3d3dy4xMjM0NTYuY29t
  date: !binary |-
    MjAxMS0wNy0xNyAwNzoyODowMyAtMDcwMA==
  date_gmt: !binary |-
    MjAxMS0wNy0xNyAxNToyODowMyAtMDcwMA==
  content: ! '<strong>Gems form the internet...</strong>


    [...]very few websites that happen to be detailed below, from our point of view
    are undoubtedly well worth checking out[...]…...'
- id: 1032
  author: !binary |-
    V29XIEFkdWx0
  author_email: !binary ""
  author_url: !binary |-
    aHR0cDovL3dvd2FkdWx0Lm5ldC90YWcvYXJpYW5h
  date: !binary |-
    MjAxMS0xMi0xMCAwMjoxNToyNyAtMDgwMA==
  date_gmt: !binary |-
    MjAxMS0xMi0xMCAxMDoxNToyNyAtMDgwMA==
  content: ! '<strong>WoW Adult...</strong>


    [...]JavaScript is Not Perfect[...]...'
- id: 1045
  author: !binary |-
    V29XIGUhQm9vaw==
  author_email: !binary ""
  author_url: !binary |-
    aHR0cDovL3dvd2Vib29rLm5ldC9jYXRlZ29yeS9idXNpbmVzcy9wYWdlLzk=
  date: !binary |-
    MjAxMS0xMi0xMiAwMToyMjoxNiAtMDgwMA==
  date_gmt: !binary |-
    MjAxMS0xMi0xMiAwOToyMjoxNiAtMDgwMA==
  content: ! '<strong>WoW e!Book...</strong>


    [...]JavaScript is Not Perfect[...]...'
- id: 1066
  author: !binary |-
    R3VhcmFudGVlZCBGYWNlYm9vayBGYW5z
  author_email: !binary ""
  author_url: !binary |-
    aHR0cDovL3d3dy5idXlndWFyYW50ZWVkLWZhY2Vib29rZmFucy5pbmZvLw==
  date: !binary |-
    MjAxMS0xMi0xNCAwODoyNDo1NyAtMDgwMA==
  date_gmt: !binary |-
    MjAxMS0xMi0xNCAxNjoyNDo1NyAtMDgwMA==
  content: ! '<strong>Extra Reading...</strong>


    [...]we like to honor other sites on the web, even if they aren''t related to
    us, by linking to them. Below are some sites worth checking out[...]...'
- id: 1099
  author: !binary |-
    QnV5IFRhcmdldGVkIEZhbnM=
  author_email: !binary ""
  author_url: !binary |-
    aHR0cDovL3d3dy5idXktdGFyZ2V0ZWRmYWNlYm9vay1mYW5zLmluZm8v
  date: !binary |-
    MjAxMS0xMi0yMCAxMzoxOTo1MSAtMDgwMA==
  date_gmt: !binary |-
    MjAxMS0xMi0yMCAyMToxOTo1MSAtMDgwMA==
  content: ! '<strong>Recommended Resources...</strong>


    [...]the time to read or visit the content or sites we have linked to below the[...]...'
- id: 1138
  author: !binary |-
    cHl0YW5pYSBkbyB6bG90eWNoIG15xZtsaQ==
  author_email: !binary ""
  author_url: !binary |-
    aHR0cDovL3B5dC1vZHAucGw=
  date: !binary |-
    MjAxMS0xMi0yNSAyMjo1MDowNiAtMDgwMA==
  date_gmt: !binary |-
    MjAxMS0xMi0yNiAwNjo1MDowNiAtMDgwMA==
  content: ! '<strong>pytania do zlotych myśli...</strong>


    [...]JavaScript is Not Perfect[...]...'
- id: 1751
  author: !binary |-
    Ynd6Ym5rcWg=
  author_email: !binary |-
    YW9mdWFvQHh3amF2eS5jb20=
  author_url: !binary |-
    aHR0cDovL2xhcWJuY251dmdtaS5jb20v
  date: !binary |-
    MjAxMi0wNS0wMSAwNDozMDoxOCAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNS0wMSAxMjozMDoxOCAtMDcwMA==
  content: A90F8H  <a href="http://aycxqtfwdjhl.com/" rel="nofollow">aycxqtfwdjhl</a>,
    [url=http://mftjfqkdodzp.com/]mftjfqkdodzp[/url], [link=http://dvvzzrpsednn.com/]dvvzzrpsednn[/link],
    http://rulykwdfbujx.com/
- id: 1972
  author: !binary |-
    RmVybmFuZG9vZG9v
  author_email: !binary |-
    bWFyeWhAaG91c2luZ2RhdGFzeXN0ZW1zLmNvbQ==
  author_url: !binary |-
    aHR0cDovL3d3dy5mYWNlYm9vay5jb20vcHJvZmlsZS5waHA/aWQ9MTAwMDAz
    NDA2MDAyNTU2
  date: !binary |-
    MjAxMi0wNS0yMSAwMjoyNTo1NSAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNS0yMSAxMDoyNTo1NSAtMDcwMA==
  content: Если дальше работа идёт с $object, то наверно небольшая :-)Согласен, надо
    было привести пример с пэкэджем, в котором определено 150 inline констант, которые
    надо вызывать типаReally::Long::Package::Names::You::Cant::Remember-&gt;USEFUL_CONSTANT_1Really::Long::Package::Names::You::Cant::Remember-&gt;USEFUL_CONSTANT_2Really::Long::Package::Names::You::Cant::Remember-&gt;USEFUL_CONSTANT_3
- id: 2128
  author: !binary |-
    U3Vu
  author_email: !binary |-
    dHlwc3lneXBzeXNAdHlwc3lneXBzeXMuY29t
  author_url: !binary |-
    aHR0cDovL3d3dy5mYWNlYm9vay5jb20vcHJvZmlsZS5waHA/aWQ9MTAwMDAz
    NDA2MDEwMTg1
  date: !binary |-
    MjAxMi0wNS0yMyAyMDo1NjoyNiAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNS0yNCAwNDo1NjoyNiAtMDcwMA==
  content: emilia                окт 08, 2009 -                                  В
    google redear за тази статия заедно с линк към страницата на фирмата ми излиза
    и един линк към  п**но фото костарева людмила   )) Помислих, че си забелязъл,
    но
- id: 2139
  author: !binary |-
    THluc2V5
  author_email: !binary |-
    YnJvd25wNUBrMTJ0bi5uZXQ=
  author_url: !binary |-
    aHR0cDovL3d3dy5nb29nbGUuY29tLw==
  date: !binary |-
    MjAxMi0wNS0yMyAyMjozMDoyNSAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNS0yNCAwNjozMDoyNSAtMDcwMA==
  content: None can doubt the veracity of this aritcle.
- id: 2148
  author: !binary |-
    YnV5IGxldml0cmE=
  author_email: !binary |-
    SG9yZHlrQHltYWlsLmNvbQ==
  author_url: !binary |-
    aHR0cDovL3d3dy5sZXZpdHJhYnV5LnVz
  date: !binary |-
    MjAxMi0wNS0yNCAwNjoyMjo0OSAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNS0yNCAxNDoyMjo0OSAtMDcwMA==
  content: http://www.buyadderall.org  Buy adderall
- id: 2238
  author: !binary |-
    Y2lhbGlzIHdpdGhvdXQgcHJlc2NyaXB0aW9u
  author_email: !binary |-
    RnVrdWRhOEBnbWFpbC5jb20=
  author_url: !binary |-
    aHR0cDovL3d3dy5jaWFsaXMtd2l0aG91dC1wcmVzY3JpcHRpb24uYml6
  date: !binary |-
    MjAxMi0wNS0yOCAwNjo1MDozMiAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNS0yOCAxNDo1MDozMiAtMDcwMA==
  content: http://www.viagra-online-without-prescription.us viagra online without
    prescription
- id: 2293
  author: !binary |-
    dmlhZ3Jh
  author_email: !binary |-
    QmFyaWFzQHltYWlsLmNvbQ==
  author_url: !binary |-
    aHR0cDovL3d3dy52aWFncmEuZ2Q=
  date: !binary |-
    MjAxMi0wNS0zMCAxNzowNjo1NSAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNS0zMSAwMTowNjo1NSAtMDcwMA==
  content: Aw, this was a really nice post. In idea I would like to put in writing
    like this additionally – taking time and actual effort to make a very good article…
    but what can I say… I procrastinate alot and by no means seem to get something
    done.
- id: 2490
  author: !binary |-
    dmlhZ3Jh
  author_email: !binary |-
    QnJlZWhsQHltYWlsLmNvbQ==
  author_url: !binary |-
    aHR0cDovL3d3dy52aWFncmEuZ2Q=
  date: !binary |-
    MjAxMi0wNi0xMCAxMjoyMDoxOCAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNi0xMCAyMDoyMDoxOCAtMDcwMA==
  content: ! 'An impressive share, I just given this onto a colleague who was doing
    a little analysis on this. And he in fact bought me breakfast because I found
    it for him.. smile. So let me reword that: Thnx for the treat! But yeah Thnkx
    for spending the time to discuss this, I feel strongly about it and love reading
    more on this topic. If possible, as you become expertise, would you mind updating
    your blog with more details? It is highly helpful for me. Big thumb up for this
    blog post!'
- id: 3427
  author: !binary |-
    SmVyb215IEdvZGJlZQ==
  author_email: !binary |-
    QmVhbW9uQGdtYWlsLmNvbQ==
  author_url: !binary |-
    aHR0cDovL2JlYXRzaGVhZHBob25lc2J5ZHIud2VlYmx5LmNvbS8=
  date: !binary |-
    MjAxMi0wNy0xOCAyMDowMDoxMCAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNy0xOSAwNDowMDoxMCAtMDcwMA==
  content: http://www.itot54joni.com/2008/03/hbot-for-autism.html
- id: 3658
  author: !binary |-
    YmVhdHMgYnkgZHJlIGNoZWFw
  author_email: !binary |-
    UGllcmFubnVuemlvQGdtYWlsLmNvbQ==
  author_url: !binary |-
    aHR0cDovL2JlYXRzaGVhZHBob25lc2J5ZHIud2VlYmx5LmNvbS8=
  date: !binary |-
    MjAxMi0wNy0yOCAwMToxNzowNCAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wNy0yOCAwOToxNzowNCAtMDcwMA==
  content: Human interest At <a href="http://beatsheadphonesbydr.weebly.com/" rel="nofollow">Beats
    By Dre</a>. Those real estate companies put out a press release in varying forms
    and in varying occasions. Thank you!
- id: 4496
  author: !binary |-
    bWFraW5nIG1vbmV5IG9uIHRoZSB3ZWI=
  author_email: !binary |-
    SGFua2VuMkBnbWFpbC5jb20=
  author_url: !binary |-
    aHR0cDovL215ZGVhbHNydXMuY29t
  date: !binary |-
    MjAxMi0wOC0zMCAwNzoxOTozNyAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wOC0zMCAxNToxOTozNyAtMDcwMA==
  content: Thank you for sharing with us, I believe this website genuinely stands
    out :D.
- id: 4658
  author: !binary |-
    a2RhcXdtbA==
  author_email: !binary |-
    ZG1zb3NxQHJncW90ZS5jb20=
  author_url: !binary |-
    aHR0cDovL3R4cm5ndnZhbGpzay5jb20v
  date: !binary |-
    MjAxMi0wOS0wNSAwNjo1MDowMyAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wOS0wNSAxNDo1MDowMyAtMDcwMA==
  content: PBb0Ib  <a href="http://fdgpnvjfmxfq.com/" rel="nofollow">fdgpnvjfmxfq</a>,
    [url=http://khghxgjqudzo.com/]khghxgjqudzo[/url], [link=http://bdnvxjlfmrtx.com/]bdnvxjlfmrtx[/link],
    http://pbrqibuaioyl.com/
- id: 4755
  author: !binary |-
    Z2V3YXltb21v
  author_email: !binary |-
    cmFsamZkZmVyOTkwOThyc0BnbWFpbC5jb20=
  author_url: !binary |-
    aHR0cDovL3NhY3Z1aXR0b25zb25saW5lc29sZGVzLmNvbS8=
  date: !binary |-
    MjAxMi0wOS0wOCAwNzo1MToyNiAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wOS0wOCAxNTo1MToyNiAtMDcwMA==
  content: xjeckwtp <a href="http://vuittonpascher.webnode.fr/#2883" rel="nofollow">sacs
    louis vuittonb</a> rgxgjmjh <a href="http://vuittonpascher.webnode.fr/#5897" rel="nofollow">sac
    louis vuittonv</a> bdyrmbso http://vuittonpascher.webnode.fr/
- id: 5210
  author: !binary |-
    aG93IHRvIG1ha2UgbW9uZXkgb25saW5lIGZvciBiZWdpbm5lcnM=
  author_email: !binary |-
    Um02QGdtYWlsLmNvbQ==
  author_url: !binary |-
    aHR0cDovL215ZGVhbHNydXMuY29t
  date: !binary |-
    MjAxMi0wOS0yNCAyMDo0MDozOSAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wOS0yNSAwNDo0MDozOSAtMDcwMA==
  content: Thank you so much for giving everyone an extraordinarily remarkable chance
    to read from this blog. It is often very nice and full of amusement for me personally
    and my office friends to search your site minimum thrice in one week to learn
    the newest tips you have. And of course, I'm at all times contented concerning
    the sensational information you serve. Certain 3 ideas in this posting are unequivocally
    the finest I have ever had.
- id: 5473
  author: !binary |-
    aG93IGNhbiBpIG1ha2UgbW9uZXkgb25saW5lIGZyZWU=
  author_email: !binary |-
    V2FyaW5lckB5bWFpbC5jb20=
  author_url: !binary |-
    aHR0cDovL2VzaG9wc3RvcC5pbmZvL0Nhc2hNYXN0ZXJ5UGFja2FnZS8=
  date: !binary |-
    MjAxMi0wOS0zMCAxMTo0NjoxNCAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0wOS0zMCAxOTo0NjoxNCAtMDcwMA==
  content: I cling on to listening to the news speak about receiving boundless online
    grant applications so I have been looking around for the best site to get one.
    Could you advise me please, where could i get some?
- id: 5658
  author: !binary |-
    Y2FuIGkgcmVhbGx5IG1ha2UgbW9uZXkgb25saW5l
  author_email: !binary |-
    SGFua2VuMkBnbWFpbC5jb20=
  author_url: !binary |-
    aHR0cDovL215ZGVhbHNydXMuY29t
  date: !binary |-
    MjAxMi0xMC0wNCAxODozOToyOSAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0xMC0wNSAwMjozOToyOSAtMDcwMA==
  content: Lovely just what I was looking for. Thanks to the author for taking his
    clock time on this one.
- id: 5990
  author: !binary |-
    eW91dHViZSBhZGVsZQ==
  author_email: !binary |-
    TGFib3JpbjFAZ21haWwuY29t
  author_url: !binary |-
    aHR0cDovL215dHZib3guaW5mbw==
  date: !binary |-
    MjAxMi0xMC0xMSAwMzo0NDoxMiAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0xMC0xMSAxMTo0NDoxMiAtMDcwMA==
  content: Thanks a lot for providing individuals with an exceptionally splendid chance
    to discover important secrets from this web site. It really is so good plus jam-packed
    with amusement for me personally and my office friends to search the blog not
    less than thrice in 7 days to study the new things you will have. And indeed,
    we are at all times pleased with your breathtaking information served by you.
    Selected 3 tips in this article are surely the most efficient I've had.
- id: 6055
  author: !binary |-
    cXVpY2sgZWFybg==
  author_email: !binary |-
    QmlnbmV5QHltYWlsLmNvbQ==
  author_url: !binary |-
    aHR0cDovL215ZXNob3BzdG9wLmluZm8vcHJvZHVjdHMvZm9yZXgtc2VjcmV0
    cy5odG0=
  date: !binary |-
    MjAxMi0xMC0xMiAxMzowODo0OCAtMDcwMA==
  date_gmt: !binary |-
    MjAxMi0xMC0xMiAyMTowODo0OCAtMDcwMA==
  content: I like this blog it's a master piece! Glad I found this on google.
- id: 21891
  author: !binary |-
    U2VvIFNlcnZpY2U=
  author_email: !binary |-
    c3VzYW56ekBnbWFpbC5jb20=
  author_url: !binary |-
    aHR0cDovL2ZpdmVyci5jb20vdXNlcnMvY3JvcmtzZXJ2aWNlLw==
  date: !binary |-
    MjAxMi0xMS0yNSAxMDowMzo0MSAtMDgwMA==
  date_gmt: !binary |-
    MjAxMi0xMS0yNSAxODowMzo0MSAtMDgwMA==
  content: 2MkANN Really enjoyed this blog. Want more.
---
After posting <a href="http://justin.harmonize.fm/index.php/2009/01/cobra-a-little-javascript-class-library/">cobra</a>, one of the things I heard most was "don't try to make JavaScript be something it's not". This is good advice, but I feel that in this case it was given too hastily. Cobra did not come out of a desire to make JavaScript more like Python, even though that was the result. Cobra came out of careful consideration of how to make JavaScript better.
<h3>Problems with JavaScript</h3>
I think most people who happen upon this lonely corner of the internet are already pretty familiar with the flaws of JavaScript, but I'll mention a couple of the most glaring faults briefly.
<h4>Scope</h4>
JavaScript's scoping rules are dumb. Variables default to the global scope unless told otherwise and the <code>this</code> keyword, which is supposed to point to the current instance, actually points to the global object unless told otherwise. These scoping rules cause huge problems for beginning JavaScript programmers and trip up the most experienced programmers if they aren't paying attention. Since these odd scoping rules default to the global object, and not to some error state, errors can go by unnoticed for long periods of time.
<h4>Object Syntax</h4>
JavaScript claims to be a prototypal language. It lies. It's a language that also has prototypes. In a true prototypal language, there are objects. Objects can be derived from other objects, either by copying the parent object or by linking to it. JavaScript does something similar with its objects' built in <code>prototype</code> attribute. Its prototype points to an object that it replicates the behavior of. However, it doesn't replicate this behavior until <em>after you create a new object.</em> Let me demonstrate with some unsupported features of JavaScript:
<pre lang="javascript">//This is my base object. It's a pretty simple 4 step dance.
Dance = {
    danceAround: function() {},
    steps: 4
}

// Let it be known that I wouldn't know what a tango was if I saw it.
// (Unless there was a rose in somebody's mouth, of course)
Tango = {
     steps: 34,
     dip: function(){}
}
// Now we pull some true prototype magic.
Tango.__proto__ = MyDance;

// This works then:
Tango.danceAround();</pre>
That's true prototypal behavior. There's no "new" keyword, just behaviors that can be stolen by other objects.  Unfortunately, JavaScript was thrown together in (I believe) about 15 minutes, minus a 5 minute coffee break. The writers realized that people were going to flip if it didn't resemble the popular languages of the time, so they implemented a prototype-based language, pulled the prototypes into a separate property, and added a "new" keyword. This led to syntax like the following:
<pre lang="javascript">//This is my base object. It's a pretty simple 4 step dance.
Dance = {
    danceAround: function() {},
    steps: 4
}

Tango = function() {
    this.dip = function();
    this.steps = 37;
}
Tango.prototype = Dance;</pre>
That's not quite as pretty. Not only is it not as pretty, but there are some fundamental flaws. The <code>dip</code> function gets recreated every time a new <code>Tango</code> object is instantiated. This isn't a big deal most of the time, but once a year the king has a ball and all of a sudden you have 1000 partners tangoing about, and with them, 1000 identical copies of the <code>dip</code> function.

Another flaw is that the prototype is not in the lookup path of the object until a new instance is instantiated. In this example, <code>Tango.danceAround</code> is not defined. This is because prototypes are not applied to objects until a new instance of the object is instantiated. A "class" in most languages is a definition of object behavior. Instances of a class are objects that behave as defined by the class. This is very close to how prototypes behave in JavaScript.

To summarize, JavaScript isn't quite a prototype based language, it isn't quite a class based language, and the syntax for doing either is ugly (for more on the ugliness, check out <a href="http://justin.harmonize.fm/index.php/2008/12/a-better-object-oriented-javascript/">one of my previous posts</a>).
<h3>Fixing the Problems</h3>
Fortunately, JavaScript is awesome in most ways. It's so flexible that fixing the issues I've spelled out above is no problem.
<h4>Fixing Scope</h4>
You can't entirely fix JavaScript scoping. Local variables which aren't declared with <code>var</code> become global, and there's nothing you can do about that.[1. If you don't care about standards or cross-platform compatibility, check out FireFox's built in <code>__parent__</code> attribute, which lets you mess around with enclosing scopes.] You can, however, fix the <code>this</code> object. You can wrap any given object method in another method which asserts that its <code>this</code> will be set to a specific object.
<pre lang="javascript">MyDance = {
     danceAround: function() { console.log(this.cheer) },
     cheer: "WHOOO!"
}

MyDance.danceAround = function() {
    MyDance.danceAround.apply(MyDance, arguments);
}</pre>
This is called binding, and it makes <code>this</code> be what you would want it to be in most instances. My initial thought was to just bind all object methods to their instances at the time of instantiation. However, I don't really like this idea. For one thing, it changes the language. For another, some libraries (I'm looking at you jQuery) like to mess around with <code>this</code>. If <code>this</code> is expected to be something, I do not want to change that. What I needed was a shadow <code>this</code>, a variable that was always present and always pointed to the instance of the object.  Luckily, there was an easy solution. <a href="http://www.python.org/">Python</a> always passes its instance object as the first parameter of any method of a class. I could replicate this behavior easily using essentially the same binding code and have the code look familiar to Python programmers everywhere. So I did. Every instance method in <a href="http://bitbucket.org/jmtulloss/cobra/">Cobra</a> has "self" passed to it as the first parameter, which is automatically guaranteed to be the instance, no matter what. No binding required.
<h4>Fixing Object Syntax</h4>
It is fairly easy to get JavaScript to <a href="http://javascript.crockford.com/prototypal.html">behave like a true prototypal language</a>. However, I don't much care for true prototypal behavior since it still leaves an ugly syntax. My solution was to create a "Class" object that will implicitly apply prototypes.

Instead of:
<pre lang="javascript">MyNewThingy.prototype.doSomeStuff = function () {};
MyNewThingy.prototype.doMoreStuff = function() {};</pre>
We can do:
<pre lang="javascript">MyNewThingy = new Class ({
    doSomeStuff: function() {},
    doMoreStuff: function() {}
});</pre>
These end up being <em>exactly</em> the same, except the latter is clearer and cleaner in my opinion.

Inheritance is a bit tricky in the first case. To achieve prototypal inheritance, I have to do some magic.
<pre lang="javascript">Base = {
   basicStuff: function() {}
}
ThingyPrototype = new function() {
      this.doSomeStuff = function () {};
      this.doMoreStuff = function() {};
}
ThingyPrototype.prototype = Base;

ChildThingy.prototype = ThingyPrototype;</pre>
Now <code>ChildThingy</code> inherits from <code>Base</code> and has some of its own functions in its prototype. Cobra takes care of all of this for you:
<pre lang="javascript">Base = new Class({
    basicStuff: function() {}
});
ChildThingy = new Class({
    __extends__: Base,
    childsOwnStuff: function() {}
});</pre>
Again, I think this is a lot clearer and cleaner.

If you put both these fixes together, you end up with <a href="http://bitbucket.org/jmtulloss/cobra/">Cobra</a>, which you can read all about <a href="http://justin.harmonize.fm/index.php/2009/01/cobra-a-little-javascript-class-library/">here</a>.

To wrap things up, augmenting JavaScript to fix its flaws is not a bad thing. The question is what to add. I haven't used Cobra for anything yet, but it's my current pet project. We'll see if it really makes JavaScript that much more pleasant.
